# Lecture 4: Brain Machine Interface

## Motor Neuroprosthetics: BMI
- communication and control system that does not depend on the brain's normal output pathways of peripheral muscles and nerves
- can directly control robots or prosthetics with brain electrical activity, but requires fast decision-making
- interfaces need to be wearable to collect data -> acquire and analyze raw signals -> extract features -> classify intent -> generate actions -> reinforcement learning to improve performance (full cycle)

## BMI Modalities
- neural activity is originated by biochemical processes and gives rises to electrical signals
  - *direct* methods measure electrical signals: EEG, MEG, ECoG, LFP, SUA, MUA
  - *indirect* methods measure hemodynamic activity (changes in blood flow): fMRI, NIRS, PET
- takeaways
  - all electrical methods are way faster
  - invasive methods like SUA/MUA have much higher spatial resolution
  - fMRI is a little slower but has high resolution and is non-invasive
- EEG is measured above the skull, ECoG is either epidural or subdural and records from cortical surface but electrodes do not penetrate cortex
  - EEG has two modalities: evoked potential and spontaneous activity
  - evoked potentials are generated automatically in response to stimuli, whereas spontaneous activity is generated by the brain itself

## Brain Machine Interfaces
- we can normalize a brain activity chart and transform it to correlate intention with movement execution

### Extracellular Recordings
- we can use a low-pass filter to capture local field potential (LFP) or a high-pass filter to capture spikes generated by neurons near the electrode
  - we have candidates neurons so we are closer to discriminating between them
  - we have millions of spikes so we can use clustering to identify neurons (SUA)
  - neurons not clustered are multi-unit activity (MUA) or were neurons 
- can cause glial scars and damage to neurons by the electrode (autoimmune response)
  - generally fine since brain automatically remaps neurons all the time so losing a few is okay -> main risk is too many scars can damage beyond repair
  - researchers are developing more biocompatible electrodes

### BMI Prediction
- we want to predict the next movement from the current brain activity (intent)
  - single neuron: from 100ms-now, we count how many times that neuron fired and use that as a feature
  - we can repeat this with many neurons and fit a simple linear discriminator as our decoder across some time window
- brain adapts super fast, monkeys initially use cursors to get reward, then brain control, then robotic arm
  - we initially see performance drops but they pick up faster with similar tasks through "transfer learning"

### Sensorimotor Rhythms
- SMRs can display **event-related desynchronization** (ERD) or **event-related synchronization** (ERS)
  - ERD is less synchronized with lower power while ERS is more synchronized with higher power